(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[907],{71033:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/proposals/create",function(){return t(32724)}])},38618:function(e,s,t){"use strict";var r=t(85893),l=t(23125),i=t(86010),a=t(67294),n=t(82082);s.Z=function(e){let{value:s="",onChange:t,wrapperClassName:o,className:c,isValid:d=!0,validator:u,validatorWaitFor:x=750,icon:h,loading:m,tabIndex:p,disabled:v,inputRef:f,...j}=e,[g,y]=a.useState(!1),N=u&&(0,n.N)(u,x);async function w(e){let{currentTarget:{value:s}}=e;"function"==typeof t&&(t(s),"function"==typeof N&&await N(s))}return(0,r.jsxs)("div",{className:(0,i.Z)("leading-11 m-0 flex h-9 rounded border border-gray-200 p-0 align-middle shadow-none transition-all duration-300",{"ring-1":g,"hover:border-blue-300 hover:shadow-blue-300":!g&&d,"border-blue-300 shadow-blue-300":g&&d,"border-red-300 hover:shadow-red-300":!g&&!d,"border-red-300 ring-red-300 shadow-red-300":g&&!d,"bg-gray-100 hover:!border-gray-300 hover:!shadow-none opacity-70":v},o),onFocus:function(){y(!0)},onBlur:function(){y(!1)},children:[h&&(0,r.jsx)("div",{className:"flex h-full items-center pl-3",children:h}),(0,r.jsx)("input",{value:s,onChange:w,tabIndex:p,className:(0,i.Z)("leading-11 h-full w-full rounded-full border-0 p-0 px-3 text-gray-600 outline-none transition-all duration-300 ease-in",{"cursor-not-allowed":v},c),disabled:v,ref:f,autoComplete:"off",role:"textbox",...j}),m&&(0,r.jsx)("div",{className:"flex h-full items-center",children:(0,r.jsx)(l._,{className:"float-right ml-2 mr-4"})})]})}},21082:function(e,s,t){"use strict";t.d(s,{E:function(){return c}});var r=t(87866),l=t(9196),i=t(67294),a=t(86501),n=t(98518),o=t(81074);function c(e){let{client:s}=(0,n.N)(),{getJsonFile:t}=(0,o.y)(),[c,d]=(0,i.useState)([]),[u,x]=(0,i.useState)(!0);(0,i.useEffect)(()=>{m().then(()=>x(!1))},[]);let h=e=>{let s=new TextDecoder,t=s.decode(e),r=t.split("ipfs://")[1];return r.split("/")[0]};async function m(){try{let i=new r.I3().setTokenId(e),a=await i.execute(s),n=await a.totalSupply,o=[];for(let e=0;e<Number(n);e++){let i=new r.Rp(a.tokenId,e+1),n=await new r.Xq().setNftId(i).execute(s),c=await t(h(null==n?void 0:n[0].metadata),l.Y1.METADATA);o.push({...c,tokenId:i.toString()})}d(o)}catch(e){a.ZP.error("Something went wrong. Please reload the page.")}}return(0,i.useMemo)(()=>({loading:u,forests:c}),[u,c])}},32724:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return G}});var r=t(85893),l=t(65037);let i=e=>"object"==typeof e&&null!==e&&Object.keys(e).length>0;var a=t(67294),n=t(784),o=t(35527),c=t(17642),d=t(68209),u=t(86237),x=t(48005),h=t(81074),m=t(32802);function p(e){let{proposal:s,onSuccess:t,onError:l}=e,{signer:i}=(0,m.aF)(),{uploadProposal:n}=(0,h.y)(),[p,v]=(0,a.useState)("stale"),[f,j]=(0,a.useState)("");(0,a.useEffect)(()=>{"stale"===p?g():"writeToHedera"===p&&y()},[p]);let g=async()=>{try{let e=await n(s);j(e),v("writeToHedera")}catch(e){l(e)}};async function y(){try{var e;let r=Math.floor(Date.now()/1e3),l=r+604800,a=(0,c.L)(),n=new d.CH(x.w.address,x.w.abi,i),o=await n.createProposal(null===(e=s.forest)||void 0===e?void 0:e.tokenId,u.s(a),f,r,l);await o.wait(),t(a)}catch(e){l(e),console.error(e)}}return(0,r.jsx)(o.K,{title:"Create Proposal",writeStatus:p})}var v=t(44926);function f(e){let{error:s,close:t}=e;return(0,r.jsxs)("div",{className:"flex flex-col items-center space-y-2",children:[(0,r.jsx)(v.M,{className:"text-2xl text-green-600"}),(0,r.jsxs)("div",{className:"text-gray-600",children:["Error: ",(0,r.jsx)("span",{onClick:t,children:"Close"})]}),(0,r.jsx)("div",{children:JSON.stringify(s,null,2)})]})}var j=t(23311),g=t(44292),y=t(87592),N=t(1449),w=function(e,s){void 0===s&&(s={});var t=(0,y.Z)(e),r=(t[0]+t[2])/2,l=(t[1]+t[3])/2;return(0,N.xm)([r,l],s.properties,s)},b=t(11163),S=t(45387);function C(e){let{id:s,proposal:t}=e,l=(0,b.useRouter)(),{submitMessage:i}=(0,S.yT)();async function n(){var e,r,a;let n=(0,g.PV)(s),o=w(null===(e=null===(r=t.forest)||void 0===r?void 0:r.properties.location)||void 0===e?void 0:e[0]);await i({type:"PROPOSAL_CREATED",location:o.geometry.coordinates,name:(null===(a=t.forest)||void 0===a?void 0:a.name)||"",route:n}),setTimeout(()=>{l.push(n)},3e3)}return(0,a.useEffect)(()=>{n()},[]),(0,r.jsxs)("div",{className:"flex flex-col items-center space-y-2",children:[(0,r.jsx)(j.l,{className:"text-2xl text-green-600"}),(0,r.jsx)("div",{children:"Success! You'll be redirected to the details page"})]})}function k(e){let{proposal:s,close:t}=e,[l,i]=(0,a.useState)(),[o,c]=(0,a.useState)();return(0,r.jsx)(n.u,{open:!0,children:(0,r.jsx)("div",{className:"py-20",children:o?(0,r.jsx)(f,{error:o,close:t}):l?(0,r.jsx)(C,{id:l,proposal:s}):(0,r.jsx)(p,{proposal:s,onSuccess:e=>i(e),onError:c})})})}var E=t(75125),P=t(38618),T=t(17708),_=t(31248);function H(e){return(0,r.jsx)(_.J,{...e,children:(0,r.jsx)("path",{d:"M864 248H728l-32.4-90.8a32.07 32.07 0 0 0-30.2-21.2H358.6c-13.5 0-25.6 8.5-30.1 21.2L296 248H160c-44.2 0-80 35.8-80 80v456c0 44.2 35.8 80 80 80h704c44.2 0 80-35.8 80-80V328c0-44.2-35.8-80-80-80zm8 536c0 4.4-3.6 8-8 8H160c-4.4 0-8-3.6-8-8V328c0-4.4 3.6-8 8-8h186.7l17.1-47.8 22.9-64.2h250.5l22.9 64.2 17.1 47.8H864c4.4 0 8 3.6 8 8v456zM512 384c-88.4 0-160 71.6-160 160s71.6 160 160 160 160-71.6 160-160-71.6-160-160-160zm0 256c-53 0-96-43-96-96s43-96 96-96 96 43 96 96-43 96-96 96z"})})}function z(e){return(0,r.jsx)(_.J,{...e,children:(0,r.jsx)("path",{d:"M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"})})}var M=t(14710),Z=function(e){let{images:s,onChange:t}=e;return(0,r.jsxs)("div",{className:"w-full",children:[(0,r.jsxs)("label",{htmlFor:"image-upload",className:"bg-transition flex w-full cursor-pointer items-center space-x-4 rounded border border-dashed border-gray-300 bg-gray-50/50 p-4 hover:bg-gray-100",children:[(0,r.jsx)("div",{className:"rounded bg-gray-100 p-2",children:(0,r.jsx)(H,{className:"text-2xl "})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-sm font-medium text-gray-700",children:"Upload images"}),(0,r.jsx)("div",{className:"text-xs text-gray-500",children:"PNG or JPG (max. 2MB)"})]})]}),(0,r.jsx)("input",{id:"image-upload",type:"file",accept:"image/*",multiple:!0,onChange:e=>{if(e.target.files){let r=Array.from(e.target.files);t([...s||[],...r])}e.target&&(e.target.value="")},className:"hidden"}),(0,r.jsx)("div",{className:"mt-4 w-full",children:(0,M.i)(s)?null==s?void 0:s.map((e,l)=>(0,r.jsxs)("div",{className:"mb-1 flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(H,{className:""}),(0,r.jsx)("div",{className:"text-sm",children:e.name})]}),(0,r.jsx)(z,{onClick:()=>{t((null==s?void 0:s.filter((e,s)=>s!==l))||[])},className:" cursor-pointer rounded text-gray-600 hover:text-red-800"})]})):(0,r.jsx)("div",{className:"text-sm text-gray-500",children:"No images uploaded"})})]})},I=t(9599);function F(e){var s,t;let{save:l,forest:i}=e,[n,o]=a.useState({title:"construction of a water park",description:"Plopsaqua, a popular chain of indoor water parks operated by Plopsa/Studio 100, plans to expand its presence by building a new facility in the city of Mechelen, Belgium. The chosen location for this new venture is the Zennebeemden, a cherished local forest rich in biodiversity and often visited by the city's residents for its serene environment."}),c=(e,s)=>o(t=>({...t,[e]:s}));return(0,r.jsxs)("div",{className:"flex w-full justify-between space-x-10",children:[(0,r.jsx)("div",{className:"w-4/12",children:(0,r.jsx)(I.B,{mode:"read-only",height:850,positions:null==i?void 0:i.properties.location})}),(0,r.jsx)("div",{className:" mt-10 w-7/12 ",children:(0,r.jsxs)("div",{className:"mx-auto w-10/12 space-y-12",children:[(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("label",{className:"text-sm",htmlFor:"title",children:"Title"}),(0,r.jsx)(P.Z,{name:"title",placeholder:"hello world",value:n.title,onChange:e=>c("title",e)})]}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("label",{className:"text-sm",htmlFor:"description",children:"Description"}),(0,r.jsx)(T.Z,{name:"description",minRows:3,placeholder:"hello world",value:n.description,onChange:e=>c("description",e)})]}),(0,r.jsx)("div",{children:(0,r.jsx)(Z,{images:n.images,onChange:e=>c("images",e)})}),(0,r.jsx)("div",{className:"!mt-10 flex justify-end space-y-1 border-t border-gray-100 pt-10",children:(0,r.jsx)(E.z,{fullSize:!0,disabled:(null===(s=n.title)||void 0===s?void 0:s.length)===0||(null===(t=n.description)||void 0===t?void 0:t.length)===0,onClick:()=>l(n),className:"px-6 py-2",variant:"primary",children:"Continue"})})]})})]})}var A=t(22784),B=t(98963);function O(e){var s;let{proposal:t,createIncident:l}=e;return(0,r.jsxs)("div",{className:"mx-auto w-6/12 rounded border border-gray-100 bg-gray-50 p-6",children:[(0,r.jsx)(I.B,{positions:null===(s=t.forest)||void 0===s?void 0:s.properties.location,height:200}),(0,r.jsxs)("div",{className:"py-6",children:[(0,r.jsx)(B.H4,{children:null==t?void 0:t.title}),(0,r.jsx)(A.n,{className:"text-sm text-gray-800",children:null==t?void 0:t.description})]}),(0,r.jsx)("div",{className:"mt-6 flex justify-end space-y-1 border-t border-gray-100 pt-6",children:(0,r.jsx)(E.z,{fullSize:!0,onClick:()=>l(),className:"px-6 py-2",variant:"primary",children:"Create Proposal"})})]})}var D=t(23125),J=t(65670);function L(e){return(0,r.jsx)(_.J,{...e,children:(0,r.jsx)("path",{d:"M912 190h-69.9c-9.8 0-19.1 4.5-25.1 12.2L404.7 724.5 207 474a32 32 0 0 0-25.1-12.2H112c-6.7 0-10.4 7.7-6.3 12.9l273.9 347c12.8 16.2 37.4 16.2 50.3 0l488.4-618.9c4.1-5.1.4-12.8-6.3-12.8z"})})}var R=t(86010);function V(e){let{forest:s,handleSelect:t,selectedForest:l}=e;return(0,r.jsxs)("div",{onClick:()=>t(s),className:(0,R.Z)("bg-transition flex w-full cursor-pointer justify-between rounded border border-transparent bg-gray-50 px-6 py-4",(null==l?void 0:l.cid)===s.cid&&"border-green-500 bg-green-50",(null==l?void 0:l.cid)!==s.cid&&"hover:bg-gray-100"),children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("div",{className:"h-8 w-8 rounded bg-gray-200"}),(0,r.jsx)("div",{className:"text-sm",children:s.name})]}),(0,r.jsx)("div",{className:(0,R.Z)("flex h-4 w-4 items-center justify-center rounded",(null==l?void 0:l.cid)===s.cid?"bg-green-600":"bg-gray-300"),children:(null==l?void 0:l.cid)===s.cid&&(0,r.jsx)(L,{className:"text-xs leading-none text-white"})})]})}var W=t(21082);function X(e){let{save:s}=e,{forests:t,loading:l}=(0,W.E)("0.0.14909792"),[i,n]=a.useState(),o=(0,a.useMemo)(()=>(null==i?void 0:i.properties.location)?null==i?void 0:i.properties.location:t.map(e=>e.properties.location).flat(),[i,t]);function c(e){(null==e?void 0:e.cid)===(null==i?void 0:i.cid)?n(void 0):n(e)}return(0,r.jsxs)("div",{className:"flex w-full justify-between space-x-10",children:[(0,r.jsx)("div",{className:"w-4/12",children:(0,r.jsx)(I.B,{mode:"read-only",height:850,positions:o})}),(0,r.jsx)("div",{className:" mt-10 w-7/12 ",children:(0,r.jsxs)("div",{className:"mx-auto w-10/12 space-y-12",children:[(0,r.jsx)("div",{className:"",children:(0,r.jsxs)("div",{className:"flex items-start space-x-6",children:[(0,r.jsx)("div",{className:"rounded bg-green-50 px-1.5 py-1",children:(0,r.jsx)(J.f,{className:"text-xl text-green-900"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"font-bold",children:"Location"}),(0,r.jsx)(A.n,{className:"text-sm text-gray-700",children:"What is the location of your forest?"})]})]})}),(0,r.jsx)("div",{className:"grid w-full grid-cols-2 gap-4",children:l?(0,r.jsx)(D._,{}):t.map((e,s)=>(0,r.jsx)(V,{forest:e,selectedForest:i,handleSelect:c},s))}),(0,r.jsx)("div",{className:"!mt-10 flex justify-end space-y-1 border-t border-gray-100 pt-10",children:(0,r.jsx)(E.z,{disabled:!i,onClick:()=>i&&s(i),className:"px-6 py-2",variant:"primary",children:"Continue"})})]})})]})}function q(){let[e,s]=(0,a.useState)(!1),[t,l]=(0,a.useState)({});return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"flex h-full items-center",children:(0,r.jsx)("div",{className:"mx-auto w-11/12",children:i(null==t?void 0:t.forest)?t.title&&t.description?(0,r.jsx)(O,{createIncident:()=>s(!0),proposal:t}):(0,r.jsx)(F,{forest:t.forest,save:e=>l(s=>({...s,...e}))}):(0,r.jsx)(X,{save:e=>l(s=>({...s,forest:e}))})})}),e&&(0,r.jsx)(k,{close:()=>s(!0),proposal:t})]})}function G(){return(0,r.jsx)(l.W,{withWidth:!1,withTopPadding:!1,children:(0,r.jsx)(q,{})})}}},function(e){e.O(0,[169,714,634,715,765,866,635,810,204,209,37,5,174,774,888,179],function(){return e(e.s=71033)}),_N_E=e.O()}]);